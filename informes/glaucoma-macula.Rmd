---
title: "Análisis del cubo macular"
date: "`r Sys.Date()`"
---

```{r knitr_init, echo=F}
library(knitr)
## Global options
options(digits = 4)
opts_chunk$set(echo=F, cache=T, prompt=F, tidy=T, comment=NA, message=F, warning=F, dev="svg")
```

```{r carga-paquetes, results='hide'}
.packages <- c("readxl", "tidyverse", "reshape2", "GGally", "gridExtra", "ggpubr", "DT", "psych", "pander")
.installed <- .packages %in% installed.packages()
if (length(.packages[!.installed])>0) install.packages(.packages[!.installed])
lapply(.packages, require, character.only=T)
```

```{r carga-datos}
# Grosor RPE
col.types = c(rep("text",3),"date", rep("text",3), rep("date",2), rep("numeric",2), rep("text",4), rep("numeric",64)) 
datos.RPE <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_EPR", col_types = col.types)
datos.RPE$Layer <- "RPE"
# Grosor GCL
datos.GCL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_GCL", col_types = col.types)
datos.GCL$Layer <- "GCL"
# Grosor INL
datos.INL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_INL", col_types = col.types)
datos.INL$Layer <- "INL"
# Grosor IPL
datos.IPL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_IPL", col_types = col.types)
datos.IPL$Layer <- "IPL"
# Grosor ONL
datos.ONL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_ONL", col_types = col.types)
datos.ONL$Layer <- "ONL"
# Grosor OPL
datos.OPL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_OPL", col_types = col.types)
datos.OPL$Layer <- "OPL"
# Grosor RNFL
datos.RNFL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_RNFL", col_types = col.types)
datos.RNFL$Layer <- "RNFL"
# Grosor total
datos.FULL <- read_excel("../datos/datos-glaucoma.xlsx", sheet = "P_P_FULL_Thickness", col_types = col.types)
datos.FULL$Layer <- "FULL"
# Fusión de datos
datos <- rbind(datos.RPE, datos.GCL, datos.INL, datos.IPL, datos.ONL, datos.OPL, datos.RNFL, datos.FULL)
# Normalización de nombres de variables
colnames(datos) <- make.names(colnames(datos))
colnames(datos)[16:79] <- paste0("Cell.",substr(colnames(datos)[16:79],6,8))
# Eliminación datos erroneos
datos.atipicos <- read.csv(file="../datos/datos-confrontacion.csv", header=T, sep=",")
id.atipicos <- datos.atipicos[is.na(datos.atipicos$SUMA.V) | datos.atipicos$SUMA.V>10, "Lastname"]
datos <- datos[!(datos$Lastname %in% id.atipicos), ]
# Conjuntos de variables
# Lista de celdas por filas
# varCells <- startsWith(colnames(datos),"Cell")
# varCells <- colnames(datos)[varCells]
# Lista de celdas por columnas
varCells <- NULL
for (i in 1:8){
  for (j in 8:1){
    varCells <- c(varCells, paste0("Cell.",j,".",i))
  }
}
matrixCells <- matrix(varCells, nrow=8, ncol=8)
submatrixCells1 <- t(matrixCells[5:8,1:4])
submatrixCells2 <- t(matrixCells[5:8,5:8])
submatrixCells3 <- t(matrixCells[1:4,1:4])
submatrixCells4 <- t(matrixCells[1:4,5:8])
submatrixCells <- list(submatrixCells1, submatrixCells2, submatrixCells3, submatrixCells4)
varCells <- NULL
for (i in 1:8){
  for (j in 1:8){
    varCells <- c(varCells, paste0("Cell.",j,".",i))
  }
}

# Celdas hemisferio inferior
cellsHI <- c(as.vector(submatrixCells1),as.vector(submatrixCells2))
# Celdas hemisferio superior
cellsHS <- c(as.vector(submatrixCells3),as.vector(submatrixCells4))

# Eliminación datos atípicos
removeOutliers <- function(x) {
  qnt <- quantile(x, probs=c(.25, .75, 0.05, 0.95), na.rm = T)
  iqr <- qnt[2]-qnt[1]
  fence1 <- qnt[1]-1.5*iqr
  fence2 <- qnt[2]+1.5*iqr
  x[x < fence1] <- qnt[3]
  x[x > fence2] <- qnt[4]
  return(x)
}
datos[datos$Glaucoma=="Y" & datos$Layer=="RPE", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="RPE", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="RPE", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="RPE", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="GCL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="GCL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="GCL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="GCL", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="INL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="INL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="INL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="INL", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="IPL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="IPL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="IPL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="IPL", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="ONL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="ONL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="ONL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="ONL", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="OPL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="OPL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="OPL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="OPL", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="RNFL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="RNFL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="RNFL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="RNFL", varCells], removeOutliers)
datos[datos$Glaucoma=="Y" & datos$Layer=="FULL", varCells] <- sapply(datos[datos$Glaucoma=="Y" & datos$Layer=="FULL", varCells], removeOutliers)
datos[datos$Glaucoma=="N" & datos$Layer=="FULL", varCells ] <- sapply(datos[datos$Glaucoma=="N" & datos$Layer=="FULL", varCells], removeOutliers)

# Añadir capa OPL+ONL+RPE
datosOPLONLRPE <- cbind(datos[datos$Layer=="OPL", 1:15], datos[datos$Layer=="OPL", varCells] + datos[datos$Layer=="ONL", varCells] + datos[datos$Layer=="RPE", varCells])
datosOPLONLRPE$Layer <- "OPL+ONL+RPE" 
datos <- rbind(datos, datosOPLONLRPE)

# Añadir capas internas RNFL+GCL+IPL
datosRNFLGCLIPL <- cbind(datos[datos$Layer=="RNFL", 1:15], datos[datos$Layer=="RNFL", varCells] + datos[datos$Layer=="GCL", varCells] + datos[datos$Layer=="IPL", varCells])
datosRNFLGCLIPL$Layer <- "RNFL+GCL+IPL" 
datos <- rbind(datos, datosRNFLGCLIPL)

# Añadir capas internas RNFL+GCL+IPL+INL
datosRNFLGCLIPLINL <- cbind(datos[datos$Layer=="RNFL", 1:15], datos[datos$Layer=="RNFL", varCells] + datos[datos$Layer=="GCL", varCells] + datos[datos$Layer=="IPL", varCells])
datosRNFLGCLIPLINL$Layer <- "RNFL+GCL+IPL+INL" 
datos <- rbind(datos, datosRNFLGCLIPLINL)

# Datos hemisferio superior e inferior
datos$Cells.HI <- apply(datos[,cellsHI],1, mean, na.rm=T)
datos$Cells.HS <- apply(datos[,cellsHS],1, mean, na.rm=T)
```

```{r filtrado-datos}
# Ojo izquierdo 
datos.L <- datos[datos$Eye=="L",]
# Ojo derecho
datos.R <- datos[datos$Eye=="R",]
# Datos Glaucoma
datos.Glaucoma = datos[datos$Glaucoma=="Y",]
# Datos Sanos
datos.Sanos = datos[datos$Glaucoma=="N",]
# Datos hemisferios
datosH <- gather(datos[, c("Layer", "Glaucoma", "Eye", "Cells.HI", "Cells.HS")], Hemisferio, Grosor, -Layer, -Glaucoma, -Eye)
```


```{r funciones}
# Funciones para dibujar distribuciones por grupos
# Resumen estadístico
describir <- function(vars, eye, layer){
  if (eye=="L"){
    result <- describeBy(datos[datos$Eye=="L" & datos$Layer==layer, varCells], datos[datos$Eye=="L" & datos$Layer==layer, "Glaucoma"], mat = T, digits = 4)
  } else {
    result <- describeBy(datos[datos$Eye=="R" & datos$Layer==layer, varCells], datos[datos$Eye=="R" & datos$Layer==layer, "Glaucoma"], mat = T, digits = 4)
  }
  result[,c("item","vars","trimmed", "mad","range","se")] <- NULL
  colnames(result)[1] <- "Glaucoma"
  return(result)
}
# Histogramas de las variables vars de la capa layer según glaucoma y ojos
overHist <- function(vars, layer){
  p <- ggplot(datos[datos$Layer==layer,], aes_string(x = vars)) + geom_histogram(aes(fill=Glaucoma), colour=I("white"), position="identity", alpha=.5) + facet_grid(Eye~.)
  return(p)
}

cellHist <- function(matrix, layer){
  for (i in 1:length(matrix)){
    p <- lapply(unlist(matrix[i]), overHist, layer=layer)
    print(do.call(ggarrange, c(p, common.legend = TRUE, legend = "top")))
  }
}

# Densidad de las variables vars de la capa layer según glaucoma y ojos
overDensity <- function(vars, layer){
  p <- ggplot(datos[datos$Layer==layer,], aes_string(x = vars)) + geom_density(aes(fill=Glaucoma), colour=I("white"), position="identity", alpha=.5) + facet_grid(Eye~.)
  return(p)
}

cellDensity <- function(matrix, layer){
  for (i in 1:length(matrix)){
    p <- lapply(unlist(matrix[i]), overDensity, layer=layer)
    print(do.call(ggarrange, c(p, common.legend = TRUE, legend = "top")))
  }
}

# Diagrama de las variables vars de la capa layer según glaucoma y ojos
overBoxplot <- function(vars, layer){
  p <- ggplot(datos[datos$Layer==layer,], aes_string(x="Eye", y = vars)) + geom_boxplot(aes(fill=Glaucoma))
  return(p)
}

cellBoxplot <- function(matrix, layer){
  for (i in 1:length(matrix)){
    p <- lapply(unlist(matrix[i]), overBoxplot, layer=layer)
    print(do.call(ggarrange, c(p, common.legend = TRUE, legend = "top")))
  }
}

# Matriz de correlación entre las celdas de la capa layer y el ojo eye
cellCorrelation <- function (eye, layer){
  cormat <- round(cor(datos[datos$Eye==eye & datos$Layer==layer, varCells], use="complete.obs"),2)
  print(datatable(cormat, rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json'))))
  melted.cormat <- melt(cormat)
  colnames(melted.cormat) <- c("Cell1", "Cell2", "R")
  melted.cormat$Cell1 <- substr(melted.cormat$Cell1, 6, 8)
  melted.cormat$Cell2 <- substr(melted.cormat$Cell2, 6, 8)
  print(ggplot(data = melted.cormat, aes(x=Cell1, y=Cell2, fill=R)) + 
          geom_tile() +
          theme(axis.text.x=element_text(size=8, angle = 90, vjust = 0.5)))
}

# Comparación de medias del grosor de las celdas del cubo macular de enfermos y sanos según ojos
comparar.medias <- function (vars, layer, eye){
  datos.layer.eye <- datos[datos$Eye==eye & datos$Layer==layer, ]
  result <- data.frame(t(sapply(datos.layer.eye[, vars], function(x) unlist(t.test(x~datos.layer.eye$Glaucoma)[c("estimate","conf.int", "p.value")]))))
  result$difference <- result$estimate.mean.in.group.N-result$estimate.mean.in.group.Y
  result<- result[c(1,2,6,3,4,5)]
  colnames(result) <- c("Media.Sanos", "Media.Glaucoma","Diferencia.medias", "lim.inf.int.conf", "lim.sup.int.conf", "p-valor")
  return(result)
}

# Intervalos de confianza para la diferencia de medias del grosor de las celdas del cubo macular de enfermos y sanos
intervalos.comparacion.medias <- function (vars, layer){
  medias.L <- comparar.medias(vars, layer, "L")
  medias.L$Cell <- substr(row.names(medias.L),6,8)
  medias.L$Cell <- factor(medias.L$Cell, levels = medias.L$Cell)
  medias.L$Eye <- "L"
  medias.R <- comparar.medias(vars, layer, "R")
  medias.R$Cell <- substr(row.names(medias.R),6,8)
  medias.R$Cell <- factor(medias.R$Cell, levels = medias.R$Cell)
  medias.R$Eye <- "R"
  medias <- rbind(medias.L, medias.R)
  print(ggplot(medias, aes(x = Cell, y = Diferencia.medias, colour=Eye)) + 
          geom_errorbar(aes(ymax = lim.sup.int.conf, ymin = lim.inf.int.conf), position = position_dodge(width = 0.5), width=.2) +
          geom_point(size = 2, position = position_dodge(0.5)) + 
          ggtitle(paste("Intervalos de confianza del 95% de la diferencia de medias\n del grosor de la capa", layer, "del cubo macular")) +
          theme(plot.title = element_text(hjust = 0.5), axis.text.x=element_text(size=8, angle = 90, vjust = 0.5))
  )
}

# Grafico comparación de medias del grosor de las celdas del cubo macular de enfermos y sanos
matriz.comparacion.medias <- function (layer){
  medias.L <- comparar.medias(varCells, layer, "L")
  medias.L$Eye <- "L"
  medias.R <- comparar.medias(varCells, layer, "R")
  medias.R$Eye <- "R"
  medias <- rbind(medias.L, medias.R) 
  medias <- mutate(medias, Eye = factor(Eye, levels=c("R", "L")),
           fila = factor(rep(rep(seq(1,8),8),2), levels=as.character(1:8)), 
           col = rep(unlist(lapply(seq(1,8), rep, 8)), 2), 
           columna = factor(paste0(col, Eye), levels = c(paste0(1:8, "R"), paste0(8:1,"L"))),
           sig = ifelse(medias$`p-valor`<0.01,"<0.01", ifelse(medias$`p-valor`<0.05, "<0.05", ">0.05"))
    )
  print(ggplot(data = medias, aes(x=columna, y=fila, fill=Diferencia.medias)) + 
          geom_tile() + 
          scale_fill_continuous(low = "indianred1", high = "indianred4") +
          geom_text(aes(label=round(Diferencia.medias,2), colour=sig), size=3) + 
          scale_colour_manual("p valor", values=c("green", "yellow","black")) + 
          scale_x_discrete(label = function(str){substring(str, 1, 1)}) +
          facet_grid(.~Eye, scales = "free_x") +
          ggtitle(paste("Diferencia de medias del grosor de la capa", layer, "del cubo macular")) +
          theme(plot.title = element_text(hjust = 0.5))
        )
}
```

# Capa total
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-total-ojo-izdo}
datatable(describir(varCells, "L", "FULL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-total-ojo-izdo}
cellCorrelation("L", "FULL")
```

### Ojo derecho

```{r tabla-descriptivos-macula-total-ojo-dcho}
datatable(describir(varCells, "R", "FULL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-total-ojo-dcho}
cellCorrelation("R", "FULL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-total}
cellHist(submatrixCells, "FULL")
```

```{r histograma-macula-total}
cellDensity(submatrixCells, "FULL")
```

```{r cajas-macula-total}
cellBoxplot(submatrixCells, "FULL")
```


## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "FULL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r}
medias.R <- comparar.medias(varCells, "FULL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-macula-total}
intervalos.comparacion.medias(varCells, "FULL")
```

```{r cubo-comparacion-medias-macula-total}
matriz.comparacion.medias("FULL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-total}
datosH %>% filter(Layer=="FULL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-total-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "FULL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom="t", autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-total-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "FULL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-total}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "FULL")
```


# Capa RNFL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-rnfl-ojo-izdo}
datatable(describir(varCells, "L", "RNFL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rnfl-ojo-izdo}
cellCorrelation("L", "RNFL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-rnfl-ojo-dcho}
datatable(describir(varCells, "R", "RNFL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rnfl-ojo-dcho}
cellCorrelation("R", "RNFL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-rnfl}
cellHist(submatrixCells, "RNFL")
```

```{r histograma-macula-rnfl}
cellDensity(submatrixCells, "RNFL")
```

```{r cajas-macula-rnfl}
cellBoxplot(submatrixCells, "RNFL")
```


## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "RNFL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "RNFL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```


```{r intervalos-confianza-comparacion-medias-macula-rnfl}
intervalos.comparacion.medias(varCells, "RNFL")
```

```{r cubo-comparacion-medias-macula-rnfl}
matriz.comparacion.medias("RNFL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-rnfl}
datosH %>% filter(Layer=="RNFL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-rnflL-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "RNFL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-rnfl-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "RNFL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-rnfl}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "RNFL")
```


# Capa GCL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-gcl-ojo-izdo}
datatable(describir(varCells, "L", "GCL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-gcl-ojo-izdo}
cellCorrelation("L", "GCL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-gcl-ojo-dcho}
datatable(describir(varCells, "R", "GCL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-gcl-ojo-dcho}
cellCorrelation("R", "GCL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-gcl}
cellHist(submatrixCells, "GCL")
```

```{r histograma-macula-gcl}
cellDensity(submatrixCells, "GCL")
```

```{r cajas-macula-gcl}
cellBoxplot(submatrixCells, "GCL")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "GCL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "GCL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-macula-gcl}
intervalos.comparacion.medias(varCells, "GCL")
```

```{r cubo-comparacion-medias-macula-gcl}
matriz.comparacion.medias("GCL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-GCL}
datosH %>% filter(Layer=="GCL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-GCLL-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "GCL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-GCL-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "GCL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-GCL}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "GCL")
```


# Capa IPL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-ipl-ojo-izdo}
datatable(describir(varCells, "L", "IPL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-ipl-ojo-izdo}
cellCorrelation("L", "IPL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-ipl-ojo-dcho}
datatable(describir(varCells, "R", "IPL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-ipl-ojo-dcho}
cellCorrelation("R", "IPL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-ipl}
cellHist(submatrixCells, "IPL")
```

```{r histograma-macula-ipl}
cellDensity(submatrixCells, "IPL")
```

```{r cajas-macula-ipl}
cellBoxplot(submatrixCells, "IPL")
```


## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "IPL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "IPL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-macula-ipl}
intervalos.comparacion.medias(varCells, "IPL")
```

```{r cubo-comparacion-medias-macula-ipl}
matriz.comparacion.medias("IPL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-IPL}
datosH %>% filter(Layer=="IPL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-IPLL-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "IPL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-IPL-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "IPL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-IPL}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "IPL")
```


# Capa INL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-inl-ojo-izdo}
datatable(describir(varCells, "L", "INL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-inl-ojo-izdo}
cellCorrelation("L", "INL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-inl-ojo-dcho}
datatable(describir(varCells, "R", "INL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-inl-ojo-dcho}
cellCorrelation("R", "INL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-inl}
cellHist(submatrixCells, "INL")
```

```{r histograma-macula-inl}
cellDensity(submatrixCells, "INL")
```

```{r cajas-macula-inl}
cellBoxplot(submatrixCells, "INL")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "INL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "INL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-macula-inl}
intervalos.comparacion.medias(varCells, "INL")
```

```{r cubo-comparacion-medias-macula-inl}
matriz.comparacion.medias("INL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-INL}
datosH %>% filter(Layer=="INL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-INLL-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "INL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-INL-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "INL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-INL}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "INL")
```


# Capa OPL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-opl-ojo-izdo}
datatable(describir(varCells, "L", "OPL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-opl-ojo-izdo}
cellCorrelation("L", "OPL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-opl-ojo-dcho}
datatable(describir(varCells, "R", "OPL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-opl-ojo-dcho}
cellCorrelation("R", "OPL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-opl}
cellHist(submatrixCells, "OPL")
```

```{r histograma-macula-opl}
cellDensity(submatrixCells, "OPL")
```

```{r cajas-macula-opl}
cellBoxplot(submatrixCells, "OPL")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "OPL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "OPL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-macula-opl}
intervalos.comparacion.medias(varCells, "OPL")
```

```{r cubo-comparacion-medias-macula-opl}
matriz.comparacion.medias("OPL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-OPL}
datosH %>% filter(Layer=="OPL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-OPLL-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "OPL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-OPL-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "OPL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-OPL}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "OPL")
```


# Capa ONL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-onl-ojo-izdo}
datatable(describir(varCells, "L", "ONL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-onl-ojo-izdo}
cellCorrelation("L", "ONL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-onl-ojo-dcho}
datatable(describir(varCells, "R", "ONL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-onl-ojo-dcho}
cellCorrelation("R", "ONL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-onl}
cellHist(submatrixCells, "ONL")
```

```{r histograma-macula-onl}
cellDensity(submatrixCells, "ONL")
```

```{r cajas-macula-onl}
cellBoxplot(submatrixCells, "ONL")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "ONL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "ONL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-macula-onl}
intervalos.comparacion.medias(varCells, "ONL")
```

```{r cubo-comparacion-medias-macula-onl}
matriz.comparacion.medias("ONL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-ONL}
datosH %>% filter(Layer=="ONL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-ONLL-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "ONL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-ONL-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "ONL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-ONL}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "ONL")
```


# Capa RPE
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-rpe-ojo-izdo}
datatable(describir(varCells, "L", "RPE"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rpe-ojo-izdo}
cellCorrelation("L", "RPE")
```


### Ojo derecho

```{r tabla-descriptivos-macula-rpe-ojo-dcho}
datatable(describir(varCells, "R", "RPE"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rpe-ojo-dcho}
cellCorrelation("R", "RPE")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-rpe}
cellHist(submatrixCells, "RPE")
```

```{r histograma-macula-rpe}
cellDensity(submatrixCells, "RPE")
```

```{r cajas-macula-rpe}
cellBoxplot(submatrixCells, "RPE")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "RPE", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "RPE", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```


```{r intervalos-confianza-comparacion-medias-macula-rpe}
intervalos.comparacion.medias(varCells, "RPE")
```

```{r cubo-comparacion-medias-macula-rpe}
matriz.comparacion.medias("RPE")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-RPE}
datosH %>% filter(Layer=="RPE") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-RPE-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "RPE", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-RPE-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "RPE", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-RPE}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "RPE")
```


# Capas internas RNFL + GCL + IPL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-rnfl-gcl-ipl-ojo-izdo}
datatable(describir(varCells, "L", "RNFL+GCL+IPL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rnfl-gcl-ipl-ojo-izdo}
cellCorrelation("L", "RNFL+GCL+IPL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-rnfl-gcl-ipl-ojo-dcho}
datatable(describir(varCells, "R", "RNFL+GCL+IPL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rnfl-gcl-ipl-ojo-dcho}
cellCorrelation("R", "RNFL+GCL+IPL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-rnfl-gcl-ipl}
cellHist(submatrixCells, "RNFL+GCL+IPL")
```

```{r histograma-macula-rnfl-gcl-ipl}
cellDensity(submatrixCells, "RNFL+GCL+IPL")
```

```{r cajas-macula-rnfl-gcl-ipl}
cellBoxplot(submatrixCells, "RNFL+GCL+IPL")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "RNFL+GCL+IPL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "RNFL+GCL+IPL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```


```{r intervalos-confianza-comparacion-medias-macula-rnfl-gcl-ipl}
intervalos.comparacion.medias(varCells, "RNFL+GCL+IPL")
```

```{r cubo-comparacion-medias-macula-rnfl-gcl-ipl}
matriz.comparacion.medias("RNFL+GCL+IPL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-rnfl-gcl-ipl}
datosH %>% filter(Layer=="RNFL+GCL+IPL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-rnfl-gcl-ipl-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "RNFL+GCL+IPL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-rnfl-gcl-ipl-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "RNFL+GCL+IPL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-rnfl-gcl-ipl}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "RNFL+GCL+IPL")
```


# Capas internas RNFL + GCL + IPL + INL
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-rnfl-gcl-ipl-inl-ojo-izdo}
datatable(describir(varCells, "L", "RNFL+GCL+IPL+INL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rnfl-gcl-ipl-inl-ojo-izdo}
cellCorrelation("L", "RNFL+GCL+IPL+INL")
```


### Ojo derecho

```{r tabla-descriptivos-macula-rnfl-gcl-ipl-inl-ojo-dcho}
datatable(describir(varCells, "R", "RNFL+GCL+IPL+INL"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-rnfl-gcl-ipl-inl-ojo-dcho}
cellCorrelation("R", "RNFL+GCL+IPL+INL")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-rnfl-gcl-ipl-inl}
cellHist(submatrixCells, "RNFL+GCL+IPL+INL")
```

```{r histograma-macula-rnfl-gcl-ipl-inl}
cellDensity(submatrixCells, "RNFL+GCL+IPL+INL")
```

```{r cajas-macula-rnfl-gcl-ipl-inl}
cellBoxplot(submatrixCells, "RNFL+GCL+IPL+INL")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "RNFL+GCL+IPL+INL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "RNFL+GCL+IPL+INL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```


```{r intervalos-confianza-comparacion-medias-macula-rnfl-gcl-ipl-inl}
intervalos.comparacion.medias(varCells, "RNFL+GCL+IPL+INL")
```

```{r cubo-comparacion-medias-macula-rnfl-gcl-ipl-inl}
matriz.comparacion.medias("RNFL+GCL+IPL+INL")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-rnfl-gcl-ipl-inl}
datosH %>% filter(Layer=="RNFL+GCL+IPL+INL") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-rnfl-gcl-ipl-inl-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "RNFL+GCL+IPL+INL", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-rnfl-gcl-ipl-inl-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "RNFL+GCL+IPL+INL", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-rnfl-gcl-ipl-inl}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "RNFL+GCL+IPL+INL")
```


# Capas externas OPL + ONL + RPE
## Estadística Descriptiva
### Ojo izquierdo

```{r tabla-descriptivos-macula-opl-onl-rpe-ojo-izdo}
datatable(describir(varCells, "L", "OPL+ONL+RPE"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-opl-onl-rpe-ojo-izdo}
cellCorrelation("L", "OPL+ONL+RPE")
```


### Ojo derecho

```{r tabla-descriptivos-macula-opl-onl-rpe-ojo-dcho}
datatable(describir(varCells, "R", "OPL+ONL+RPE"), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

#### Correlaciones

```{r correlaciones-macula-opl-onl-rpe-ojo-dcho}
cellCorrelation("R", "OPL+ONL+RPE")
```

### Comparación de distribuciones por glaucoma y ojo
```{r densidad-macula-opl-onl-rpe}
cellHist(submatrixCells, "OPL+ONL+RPE")
```

```{r histograma-macula-opl-onl-rpe}
cellDensity(submatrixCells, "OPL+ONL+RPE")
```

```{r cajas-macula-opl-onl-rpe}
cellBoxplot(submatrixCells, "OPL+ONL+RPE")
```

## Comparación de medias
### Ojo izquierdo
```{r}
medias.L <- comparar.medias(varCells, "OPL+ONL+RPE", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r, digits=3}
medias.R <- comparar.medias(varCells, "OPL+ONL+RPE", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(pageLength = 8, autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```


```{r intervalos-confianza-comparacion-medias-macula-opl-onl-rpe}
intervalos.comparacion.medias(varCells, "OPL+ONL+RPE")
```

```{r cubo-comparacion-medias-macula-opl-onl-rpe}
matriz.comparacion.medias("OPL+ONL+RPE")
```

## Comparación de Hemisferios
```{r cajas-hemisferios-opl-onl-rpe}
datosH %>% filter(Layer=="OPL+ONL+RPE") %>% ggplot(aes(x=Eye, y=Grosor, fill=Glaucoma)) + geom_boxplot() + facet_grid(.~Hemisferio)
```

### Ojo izquierdo
```{r comparacion-medias-hemisferios-macula-opl-onl-rpe-izdo}
medias.L <- comparar.medias(c("Cells.HI","Cells.HS"), "OPL+ONL+RPE", "L")
datatable(format(medias.L, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

### Ojo derecho
```{r omparacion-medias-hemisferios-macula-opl-onl-rpe-drcho}
medias.R <- comparar.medias(c("Cells.HI","Cells.HS"), "OPL+ONL+RPE", "R")
datatable(format(medias.R, nsmall=2), rownames = T, escape=F, options = list(dom = 't', autoWidth = T, language = list(url = 'http://cdn.datatables.net/plug-ins/1.10.11/i18n/Spanish.json')))
```

```{r intervalos-confianza-comparacion-medias-hemisferios-macula-opl-onl-rpe}
intervalos.comparacion.medias(c("Cells.HI","Cells.HS"), "OPL+ONL+RPE")
```

